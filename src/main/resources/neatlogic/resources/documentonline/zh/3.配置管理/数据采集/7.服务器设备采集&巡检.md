# 服务器设备采集&巡检

## 服务器设备数据采集
服务器设备采集数据来源：
* 操作系统层面采集[操作系统采集](2.操作系统采集.md)（适用于物理机上直接安装操作系统）。
* 虚拟化平台采集[虚拟化平台采集](5.容器云平台采集.md)(适用于虚拟化中服务器组成集群情况)。
* 服务器硬件详细指标参见系统内服务器硬件数据字典。
<br>
<b>说明：</b> vsphere版本低于5.7无法采集硬件资产sn序列号，所以服务器硬件建议设置联合主键。
## 服务器设备巡检
服务器设备巡检采用ipmi协议，待采集的设备必须提供带外管理网卡IP，以及开启ipmi服务和具备管理员角色权限用户。

### 巡检指标
主要包括：传感器、电源、风扇、日志等指标。

## 服务器设备巡检组合工具示例
巡检插件和巡检数据归档到MongoDB插件
![img.png](images/7.serverdev_inspect_comb.png)

## 巡检结果
![img.png](images/7.serverdev_inspect_result.png)
## 采集数据同步到配置管理
<b>关于配置映射和策略执行:</b> 详细参考[同步数据配置映射](8.同步数据配置.md)。

# 常见FAQ
## 巡检采集找不到命令
```shell
# 安装工具
yum -y install ipmitool
# 测试
ipmitool -h
```

## 测试验证
```shell
# 格式
ipmitool -I lanplus -H 带外网卡IP -U 用户 -P 密码 传感器类型
# 示例
ipmitool -I lanplus -H 192.168.0.100 -U root -P root sdr
```
