# 1. 如何发起一个工单
发起工单前需要配置管理人员完成基础的配置，步骤如下：
1. 创建表单
2. 创建流程
3. 添加服务

完成服务的配置后，用户才能通过服务应用发起工单 。

## 权限
添加服务目录为系统管理功能，需要当前用户拥有以下权限。

- 表单管理权限

![](image/表单管理权限.png)

- 流程管理权限

![](image/流程管理权限.png)


- 服务目录管理权限
 
![](image/服务目录权限.png)


## 1.1 创建表单

**表单**：即用户在上报页面填写的上报内容，如下图

![](image/添加服务目录-表单-1.png)

ITSM系统，需要用户根据不同的工单上报场景，添加自定义表单

- 添加表单入口

系统配置->表单管理->添加表单
![](image/添加服务目录-表单-添加入口.png)

- 添加表单控件

支持文本框、富文本框、下拉、单选、多选、时间、等组件，根据服务需求，将需要的控件拖拽到表单区域即可
![](image/添加服务目录-添加表单演示.gif) 
表单更多详情参考文档：[表单管理](../100.系统配置/3.数据和集成/表单管理.md).

## 1.2 添加流程

**流程**：即用户上报工单后，后台的处理过程，如下图

![](image/添加服务目录-创建流程-流程例示.png)

ITSM系统，需要用户根据不同的工单上报场景，添加自定义流程

- 添加入口

![](image/添加服务目录-添加流程入口.png)

- 设置流程属性

选择关联表单、设置权限、选择通知策略

![](image/添加服务目录-添加流程-流程设置.gif)

- 拖拽流程节点步骤

![](image/添加服务目录-添加流程-拖拽节点.gif)

- 设置流程节点

设置节点名称、处理人、权限、通知策略等

![](image/添加服务目录-添加流程-设置节点.gif)

流程更多详情请参考文档：[流程管理](流程管理/流程管理.md)。

## 1.3 添加服务目录

- 添加入口

![](image/添加服务目录-添加入口.png)

- 添加服务目录
设置服务名称、选择流程、选择优先级、服务窗口、服务类型等

![](image/添加服务目录.gif)
服务目录更多详情请参考文档：[服务目录管理](服务/服务目录管理.md)。

## 1.4 上报工单

![](image/添加服务目录-完成.png)
上报工单更多详情请参考文档：[工单上报](工单上报/工单上报.md)。

# 2. 如何给工单步骤设置处理时效
当事件某个步骤有处理时间限制时，可以通过工单的时效策略来实现，效果如图所示，工单步骤显示剩余时间倒计时。
![](image/工单时效效果图.png)
工单时效的配置包括： 服务窗口配置、流程管理-时效设置。<br>
当工单同时满足在服务窗口的时间范围内且满足步骤时效生效的条件时，流转到制定步骤时，就会提示剩余处理时间。

## 2.1 服务窗口配置
发起工单的服务有服务窗口配置，工单的时效策略只在服务窗口的时间内才能生效，且只按照服务窗口的时间计算，若当日服务窗口剩余时间小于时效剩余时间，则会跨日期计算。

配置服务窗口的操作步骤：添加服务窗口-排班，详情可参考[服务窗口管理](../100.系统配置/5.基础服务/服务窗口管理.md)。

## 2.2 流程-时效设置
发起工单的服务所引用的工作流程中，要在时效设置中配置步骤的时效，详情请参考 [流程管理](流程管理/流程管理.md)-时效设置。
![](image/流程时效策略效果图.png)

# 3. 如何通过工单同步配置项数据
通过工单将配置项变更数据同步到配置管理，同步效果如图所示。
   ![](image/配置项同步.png)

步骤：
  1. 设计包含配置项修改组件的表单。
  2. 设计包含配置项同步节点的流程。
  3. 配置发起配置项变更的服务。
  4. 发起工单，并同步配置项数据。

## 3.1 表单配置
打开表单管理，设计配置项同步的表单，在表单中添加**配置项修改**组件，详情参考[表单管理](../100.系统配置/3.数据和集成/表单管理.md)-表单配置-表单组件-组件配置-配置项修改。
![](../100.系统配置/3.数据和集成/images/表单管理_表单组件_配置项修改.png)

## 3.2 流程配置
打开流程管理，设计配置项修改并同步的流程，流程中要用到配置项同步节点，详情参考 [流程管理](流程管理/流程管理.md)-流程节点-配置项同步节点。
![](流程管理/images/流程管理_配置项同步.png)

## 3.3 创建服务
在服务目录管理页面，添加一个服务，服务工作流引用上述的配置项同步流程，详情参考 [服务目录管理](服务/服务目录管理.md) 文档。
![](image/服务目录管理_配置项同步.png)

## 3.4 上报和处理
上报工单，在配置项修改组件中添加新增、编辑或删除配置项的操作。
![](image/工单上报_修改配置项.gif)
完成变更后提交工单，流转到配置项同步节点，自动将数据同步到配置管理中，可在步骤日志查看同步结果。
![](image/工单处理_修改配置项.gif)
更多详情参考文档：[工单上报](工单上报/工单上报.md)，[工单处理](工单处理/工单处理.md)。

# 4. 如何通过表单修改优先级
工单支持通过修改表单组件的数据，联动修改工单的优先级。

效果展示步骤：
1. 设计表单，组件配置修改优先级联动
2. 设计流程，引用1中表单
3. 配置服务
4. 发起工单，修改表单组件

## 4.1 表单配置
通过表单修改优先级有两种细分场景

1. 直接修改表单的组件实现修改优先级
   
    在表单管理添加修改优先级表单，添加一个下拉框组件，引用优先级矩阵作为数据源，值的映射对象必须是“名字”，也支持配置静态数据源，选项的值必须和工单优先级的名称匹配。<br>
    然后配置修改优先级的联动，触发事件联动不需要条件，直接选择事件即可，如图所示。更多表单配置详情，参考[表单管理](../100.系统配置/3.数据和集成/表单管理.md)。
  ![](image/修改优先级_表单配置.png)

2. 通过修改多个表单组件的数据，过滤出优先级数据并修改优先级，这种场景只支持过滤后只有一个优先级的情况。
    
    比如场景是通过选择“应用系统”和“严重程度”自动匹配优先级。<br>
    需要在表单中添加两个下拉框组件，分别作为“应用系统”和“系统级别”。
    ![](image/表单管理_过滤优先级.png)
    然后添加一个隐藏下拉框组件，配置组件的数据源，并设置过滤联动，如图所示。
    ![](image/表单管理_隐藏组件优先级.png)
    并且启用默认选中配置，过滤后仅有一个优先级才能生效。
    ![](image/表单管理_优先级默认选中.png)
    
    数据源说明：为了方便实现过滤联动，上面的三个下拉框组件数据源来自同一个矩阵，详情参考[表单管理](../100.系统配置/3.数据和集成/表单管理.md)-表单联动配置。

## 4.2 流程配置
打开流程管理，设计流程图，在流程设置中关联 4.1 的表单。
![](image/流程管理_修改优先级.png)

## 4.3 创建服务
打开服务目录管理页面，添加引用 4.2 流程的服务。
![](image/服务目录_修改优先级.png)

## 4.4 工单效果
打开服务目录页面，找到修改优先级的服务，点击服务，跳转到工单上报页面，修改表单中联动优先级的下拉框的值，工单优先级随之改变。
![](image/工单上报_修改优先级.gif)

# 5. 延长超时时间
延长超时时间主要是通过调用“延迟工单步骤时效接口”来实现，有两种方式。
1. 通过接口调用工具发起请求，接口详情可访问[接口管理](../100.系统配置/5.基础服务/接口管理.md)页面，搜索 “processtask/step/sla/delay”。
2. 通过站内的流程节点-外部调用节点，调用集成配置（延迟工单步骤时效的集成配置）。

